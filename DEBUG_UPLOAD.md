# 🔍 영상 업로드 디버깅 가이드

## 현재 상황
- 42MB 영상을 업로드했지만 9.96MB만 저장됨
- 파일이 잘리거나 업로드가 중단된 것으로 보임

## 원인 가능성

### 1. Next.js 바디 크기 제한
Next.js는 기본적으로 API 요청 바디 크기를 제한합니다.

### 2. 브라우저 타임아웃
대용량 파일 업로드 시 시간 초과

### 3. 네트워크 문제
업로드 중 연결 끊김

## 해결 방법

### 방법 1: 브라우저 콘솔 확인 (가장 중요!)

1. **F12** 눌러서 개발자 도구 열기
2. **Console 탭** 확인
   - 빨간색 에러 메시지 확인
   - "Failed to fetch" 또는 "Network error" 확인
3. **Network 탭** 확인
   - 업로드 요청 찾기 (presign, upload)
   - 상태 코드 확인 (200, 413, 500 등)
   - Response 탭에서 에러 메시지 확인

### 방법 2: 업로드 진행 상황 확인

업로드 페이지에서:
1. 파일 선택
2. 진행률 표시 확인
3. "업로드 중..." 메시지 확인
4. 완료 메시지 또는 에러 메시지 확인

### 방법 3: 서버 터미널 확인

서버 터미널에서:
- 업로드 시 로그 확인
- 에러 메시지 확인
- 파일 크기 로그 확인

## 테스트 방법

### 1. 작은 파일로 테스트
먼저 5MB 정도의 작은 영상으로 테스트:
1. 작은 영상 파일 준비
2. 업로드
3. 성공하면 → 파일 크기 제한 문제
4. 실패하면 → 다른 문제

### 2. 브라우저 변경
- Chrome에서 안 되면 Edge 시도
- 시크릿 모드로 시도

### 3. 직접 URL 테스트
업로드 후 직접 URL 접속:
```
http://localhost:3000/uploads/asset-3d1c74b6-4ed0-479e-a453-8e64fd0d178e/index.mp4
```

## 예상 에러 메시지

### "413 Payload Too Large"
→ Next.js 바디 크기 제한 초과
→ next.config.ts 수정 필요

### "Failed to fetch"
→ CORS 문제 또는 네트워크 문제
→ 업로드 API CORS 헤더 확인

### "Network error"
→ 타임아웃 또는 연결 끊김
→ 파일을 여러 청크로 나눠서 업로드 필요

### "ENOENT" 또는 "EPERM"
→ 파일 시스템 권한 문제
→ 관리자 권한으로 서버 실행

## 임시 해결책

### 영상 압축
42MB → 20MB 이하로 압축:
1. HandBrake 또는 FFmpeg 사용
2. 해상도 낮추기 (1080p → 720p)
3. 비트레이트 낮추기

### 파일 분할
대용량 파일을 여러 개로 분할

## 정보 수집

다음 정보를 확인해주세요:

1. **브라우저 콘솔 에러**
   ```
   F12 → Console 탭
   → 에러 메시지 복사
   ```

2. **Network 탭 상태**
   ```
   F12 → Network 탭
   → presign 요청 상태 코드
   → upload 요청 상태 코드
   → Response 내용
   ```

3. **서버 터미널 로그**
   ```
   업로드 시 터미널에 출력되는 메시지
   ```

4. **파일 정보**
   ```
   파일명: korea_hiphop_ai_musicvedio_satan1.mp4
   크기: 42.1 MB
   형식: MP4
   ```

## 다음 단계

위 정보를 확인한 후:
1. 브라우저 콘솔의 에러 메시지 공유
2. Network 탭의 상태 코드 공유
3. 서버 터미널의 로그 공유

그러면 정확한 원인을 파악하고 해결할 수 있습니다!
